# Production requirements for CPU-only API deployment (Hetzner + Coolify)
# Excludes: GPU dependencies, ASR/diarization, ingestion pipeline
# Use this for backend API servers that only serve search/answer endpoints
#
# CRITICAL: Install order matters! See Dockerfile for proper sequence.
# NumPy MUST be installed before PyTorch to prevent NumPy 2.x from being pulled in.

# ============================================================================
# NUMPY (MUST BE FIRST - installed in Dockerfile before PyTorch)
# ============================================================================
# CRITICAL: NumPy 2.x breaks PyTorch 2.1.2 - always use NumPy 1.x
# Flexible constraint allows 1.24.x, 1.25.x, 1.26.x (all compatible with torch 2.1.2)
numpy<2.0.0

# ============================================================================
# PYTORCH CPU-ONLY (installed in Dockerfile after NumPy)
# ============================================================================
# torch==2.1.2+cpu
# torchvision==0.16.2+cpu
# torchaudio==2.1.2+cpu
# Installed via: pip install --index-url https://download.pytorch.org/whl/cpu

# ============================================================================
# CORE DEPENDENCIES (safe to install anytime)
# ============================================================================
psycopg2-binary==2.9.11
alembic==1.17.2
sqlalchemy==2.0.44
python-dotenv==1.2.1
tqdm==4.67.1
isodate==0.7.2
psutil==5.9.8

# ============================================================================
# WEB API
# ============================================================================
fastapi==0.124.0
uvicorn==0.38.0  # Plain uvicorn (NOT [standard]) - avoids NumPy 2.x conflicts
python-multipart==0.0.20
aiofiles==23.2.1
click==8.3.1
h11==0.16.0

# ============================================================================
# EMBEDDINGS (installed AFTER PyTorch in Dockerfile)
# ============================================================================
# Versions compatible with torch==2.1.2 and numpy==1.24.3
sentence-transformers==2.7.0
transformers==4.57.3
tokenizers==0.22.1
huggingface-hub==0.36.0
safetensors==0.7.0
regex==2023.12.25
filelock==3.20.0
packaging==23.2
requests==2.32.5
urllib3==2.6.0
certifi==2023.11.17
charset-normalizer==3.4.4
idna==3.11

# ============================================================================
# OPENAI (for answer generation)
# ============================================================================
openai==1.109.1
anyio==3.7.1
sniffio==1.3.1
httpx==0.28.1
httpcore==1.0.9
pydantic==2.12.5
pydantic-core==2.41.5
typing-extensions==4.15.0
distro==1.9.0

# ============================================================================
# EXCLUDED FROM PRODUCTION
# ============================================================================
# The following are NOT needed for API-only deployment:
# - celery, redis (background jobs - not used in API)
# - youtube-transcript-api, yt-dlp (ingestion only)
# - google-api-python-client (ingestion only)
# - faster-whisper, ctranslate2 (ASR - ingestion only)
# - pyannote.audio, speechbrain (diarization - ingestion only)
# - soundfile, webvtt-py (audio processing - ingestion only)
# - asyncio-throttle, apscheduler, aiohttp (ingestion only)
# - black, ruff, pytest (development only)
