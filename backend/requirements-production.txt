# Production requirements for CPU-only API deployment (Hetzner + Coolify)
# Excludes: GPU dependencies, ASR/diarization, ingestion pipeline
# Use this for backend API servers that only serve search/answer endpoints

# ============================================================================
# CORE DEPENDENCIES
# ============================================================================
psycopg2-binary>=2.9.9
alembic>=1.13.0
sqlalchemy>=2.0.7
python-dotenv==1.0.0

# NumPy 2 is currently breaking PyTorch / HF stack in our image.
# Pin to a stable 1.x release that is well supported.
numpy<2.0.0

tqdm==4.66.1

# ============================================================================
# WEB API
# ============================================================================
fastapi==0.104.1
uvicorn[standard]==0.24.0
python-multipart==0.0.18  # Security fix applied
aiofiles==23.2.1

# ============================================================================
# EMBEDDINGS (CPU-ONLY)
# ============================================================================
# Use versions known to work well with torch==2.1.2 CPU
sentence-transformers==2.2.2
transformers==4.36.2

# PyTorch CPU-only (installed in Dockerfile, not here)
# IMPORTANT: keep these pinned together for compatibility
#   torch==2.1.2
#   torchvision==0.16.2
#   torchaudio==2.1.2
# Installed via:
#   pip install --index-url https://download.pytorch.org/whl/cpu \
#       torch==2.1.2 torchvision==0.16.2 torchaudio==2.1.2

# ============================================================================
# UTILITIES
# ============================================================================
isodate==0.6.1
psutil>=5.9.0

# ============================================================================
# OPENAI (for answer generation)
# ============================================================================
openai>=1.0.0

# ============================================================================
# EXCLUDED FROM PRODUCTION
# ============================================================================
# The following are NOT needed for API-only deployment:
# - celery, redis (background jobs - not used in API)
# - youtube-transcript-api, yt-dlp (ingestion only)
# - google-api-python-client (ingestion only)
# - faster-whisper, ctranslate2 (ASR - ingestion only)
# - pyannote.audio, speechbrain (diarization - ingestion only)
# - soundfile, webvtt-py (audio processing - ingestion only)
# - asyncio-throttle, apscheduler, aiohttp (ingestion only)
# - black, ruff, pytest (development only)
