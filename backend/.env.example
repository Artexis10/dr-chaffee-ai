# =============================================================================
# DR. CHAFFEE AI - BACKEND CONFIGURATION EXAMPLE
# =============================================================================
# Copy this file to .env and fill in your actual values

# =============================================================================
# DATABASE
# =============================================================================
# PostgreSQL connection string with pgvector extension
DATABASE_URL=postgresql://user:password@host:5432/database

# =============================================================================
# YOUTUBE
# =============================================================================
# YouTube channel to ingest videos from
YOUTUBE_CHANNEL_URL=https://www.youtube.com/@anthonychaffeemd

# Optional: YouTube Data API key for faster video listing
# Leave empty to use yt-dlp instead (slower but no API key needed)
YOUTUBE_API_KEY=

# =============================================================================
# WHISPER ASR (Speech Recognition)
# =============================================================================
# Model: distil-large-v3 (GPU), base (CPU)
WHISPER_MODEL=distil-large-v3

# Compute type: int8_float16 (GPU), int8 (CPU)
WHISPER_COMPUTE=int8_float16

# Device: cuda (GPU), cpu (CPU)
WHISPER_DEVICE=cuda

# Beam size: 5 (GPU), 3 (CPU) - higher = better quality, slower
BEAM_SIZE=5

# Temperature: 0.0 = deterministic, >0 = more creative
TEMPERATURE=0.0

# =============================================================================
# CONCURRENCY (Adjust based on hardware)
# =============================================================================
# GPU: 12, CPU: 4
IO_WORKERS=12

# GPU: 2, CPU: 1
ASR_WORKERS=2

# GPU: 12, CPU: 4
DB_WORKERS=12

# =============================================================================
# SEGMENTATION (For optimal RAG quality)
# =============================================================================
# Minimum characters per segment (good context window)
SEGMENT_MIN_CHARS=1100

# Maximum characters per segment
SEGMENT_MAX_CHARS=1400

# Maximum gap between sentences to merge (seconds)
SEGMENT_MAX_GAP_SECONDS=5.0

# Maximum duration of merged segment (seconds)
SEGMENT_MAX_MERGE_DURATION=120.0

# =============================================================================
# SPEAKER IDENTIFICATION
# =============================================================================
# Enable speaker diarization (separates Chaffee from guests)
ENABLE_SPEAKER_ID=true

# Assume single speaker for faster processing (3x speedup)
ASSUME_MONOLOGUE=true

# Minimum similarity threshold for Chaffee identification
CHAFFEE_MIN_SIM=0.62

# Minimum similarity threshold for guest identification
GUEST_MIN_SIM=0.82

# Clustering threshold for pyannote (lower = more sensitive)
PYANNOTE_CLUSTERING_THRESHOLD=0.3

# =============================================================================
# EMBEDDINGS (Semantic Search)
# =============================================================================
# Profile: 'quality' (GTE-Qwen2-1.5B, 1536-dim) or 'speed' (BGE-Small, 384-dim)
EMBEDDING_PROFILE=quality

# Device: cuda (GPU), cpu (CPU)
EMBEDDING_DEVICE=cuda

# =============================================================================
# PROCESSING SETTINGS
# =============================================================================
# Skip YouTube Shorts (usually not useful content)
SKIP_SHORTS=true

# Process newest videos first
NEWEST_FIRST=true

# Delete audio files after processing (saves disk space)
CLEANUP_AUDIO_AFTER_PROCESSING=true

# Store audio files permanently (not recommended)
STORE_AUDIO_LOCALLY=false

# =============================================================================
# API KEYS
# =============================================================================
# HuggingFace token for downloading models
HUGGINGFACE_HUB_TOKEN=hf_your_token_here

# OpenAI API key for answer generation (optional)
OPENAI_API_KEY=sk-proj-your_key_here

# Model: gpt-3.5-turbo (cheap), gpt-4o (expensive)
SUMMARIZER_MODEL=gpt-3.5-turbo

# =============================================================================
# AUTHENTICATION
# =============================================================================
# Simple password for admin endpoints
APP_PASSWORD=your_secure_password_here
